


<div class="main-cont">

  <div class="race-menu">
    <img class="menu-logo" src="/assets/base/images/binary-race/binary-logo.png" alt="" [routerLink]="['/race/start-race']">
    <div class="mobile-handler" [ngClass]="{'mobile-open': menuOpen === true}">
  
      <div class="right-items">
        <div class="name-holder">
          <div class="avatar">
            <img src="/assets/base/images/menu/user-ico-red.svg" alt="">
          </div>
          <p>{{ myDriverStats?.nickname }}</p>
        </div>
        <div class="switch-btn">
          <img src="/assets/base/images/zavod/sound-icon.svg" alt="icon of sound">
        </div>
        <div class="switch-btn">
          <img src="/assets/base/images/zavod/info-icon.svg" alt="">
        </div>
      </div>

      <div class="center-items">
        <div class="small-box">
          <img src="/assets/base/images/binary-race/win-icon.svg" alt="">
          <p>Potential win: 1.6 IOI</p>
        </div>
        <div class="small-box">
          <img src="/assets/base/images/binary-race/balance-icon.svg" alt="">
          <p>Balance: {{balance}} IOI</p>
        </div>
        <button class="quit-btn"  [routerLink]="['/race/start-race']">Quit game</button>
      </div>

    </div>

    <div
      class="my-mobile-button"
      (click)="menuOpen = !menuOpen"
      [ngClass]="{ open: menuOpen === true }"
    >
      <span class="my-cta-btn-back"></span>
      <span class="my-cta-btn-back"></span>
      <span class="my-cta-btn-back"></span>
      <span class="my-cta-btn-back"></span>
    </div>

  </div>
  <div *ngIf="players?.length > 1" class="unity-holder">

    <app-unityrace [players]="players" #unityRace style="width: 100%;
          height: 100%;
          position: relative;
          background: black;
          z-index: 1;" >
    </app-unityrace> 
  </div>
  <div class="content-holder">
    <div class="mobile-avatars">
      <div class="avatar-box">
        <img src="/assets/base/images/nft-racers/white-trm.png" alt="">
      </div>
      <div class="avatar-box rival">
        <img src="/assets/base/images/nft-racers/red-trm.png" alt="">
      </div>
    </div>
    <div class="chart-holder">
      <div class="react-controls" *ngIf="mePlaying === true">
        <p>React!</p>
        <div class="control-btns">
          <button class="react-btn" (click)="sendSockAvatarMsg({'user_hash': myId, 'reaction': 2});avatarMsgLocal({user_hash: myId, reaction: 2})" [disabled]="locked === true">
            <div class="inner">
              <img src="/assets/base/images/binary-race/react-possitive.svg" alt="">
            </div>
          </button>
  
          <button class="react-btn" (click)="sendSockAvatarMsg({'user_hash': myId, 'reaction': 3});avatarMsgLocal({user_hash: myId, reaction: 3})" [disabled]="locked === true">
            <div class="inner">
              <img src="/assets/base/images/binary-race/react-negative.svg" alt="">
            </div>
          </button>
  
          <button class="react-btn" (click)="sendSockAvatarMsg({'user_hash': myId, 'reaction': 4});avatarMsgLocal({user_hash: myId, reaction: 4})" [disabled]="locked === true">
            <div class="inner">
              <img src="/assets/base/images/binary-race/react-diss.svg" alt="">
            </div>
          </button>
              </div>

        <div class="conv-box">
          <p>BTC/USD</p>
        </div>
      </div>
      <div id="container">

      </div>
      <canvas id="canvas"  [hidden]="showChart === false">

      </canvas>

      
      <div class="timer-count" *ngIf="optWaiting !== 0">

        <div class="tc-wrap">
          <app-timer [value]="10" (onComplete)="optTimerCompleted($event)"></app-timer>        </div>
      </div>

      <div class="semafor-wrap visible"  *ngIf="semaforsVisible === true">

        <div class="semafor-inner">
          <div class="color-box">
            <p class="desc">Race starts in</p>
            <p class="time" *ngIf="semaforVal > 1">{{semaforVal - 1}}s</p>
            <p class="time" *ngIf="semaforVal < 2">GO!</p>
          </div>

          <div class="circles-holder">
            <div class="semaf" [ngClass]="{'red': semaforVal < 6 && semaforVal > 1, 'green': semaforVal < 2}"></div>
            <div class="semaf" [ngClass]="{'red': semaforVal < 5 && semaforVal > 1, 'green': semaforVal < 2}"></div>
            <div class="semaf" [ngClass]="{'red': semaforVal < 4 && semaforVal > 1, 'green': semaforVal < 2}"></div>
            <div class="semaf" [ngClass]="{'red': semaforVal < 3 && semaforVal > 1, 'green': semaforVal < 2}"></div>
            <div class="semaf" [ngClass]="{'green': semaforVal < 2}"></div>
          </div>
      
        </div>
      </div>

    </div>

    <div class="control-panel">
      <div class="player-stats mine">
        <p class="name">{{players[0]?.user_nickname}}</p>

        <div class="targets-holder">
          <div class="target-item" [ngClass]="{okey: myShots[0] === 1, wrong: myShots[0] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          <div class="target-item" [ngClass]="{okey: myShots[1] === 1, wrong: myShots[1] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          <div class="target-item" [ngClass]="{okey: myShots[2] === 1, wrong: myShots[2] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          <div class="target-item" [ngClass]="{okey: myShots[3] === 1, wrong: myShots[3] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          <div class="target-item" [ngClass]="{okey: myShots[4] === 1, wrong: myShots[4] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          <div class="target-item" [ngClass]="{okey: myShots[5] === 1, wrong: myShots[5] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          
        </div>

        <div class="my-progress">
          <div class="inner-bar"></div>
        </div>

        <p class="percent" *ngIf="roileft">{{roileft}}%</p>

      </div>

      <div class="player-controls">
        <div class="control-btn down" (click)="long = false;placeOption();">
          <img src="/assets/base/images/binary-race/down-icon.svg" alt="">
        </div>
        <div class="data-box bordered">
          <img src="/assets/base/images/binary-race/btc-logo.svg" alt="">
        
          <p *ngIf="currentValue; else loading">
            &#36; {{currentValue}}
              </p>
          5
          <ng-template #loading>
            <p>Loading</p>
          </ng-template>
        </div>
        <div class="data-box">
          <img src="/assets/base/images/binary-race/time-icon.svg" alt="">
          <p class="bin-trade" *ngIf="startsInSecs">
            <app-timer [value]="startsInSecs"></app-timer> sec
          </p>
        </div>
        <div class="control-btn up" (click)="long = true;placeOption();">
          <img src="/assets/base/images/binary-race/up-icon.svg" alt="">
        </div>
      </div>

      <div class="player-stats rival">
        <p class="name">{{players[1]?.user_nickname}}</p>

        <div class="targets-holder">
          <div class="target-item" [ngClass]="{okey: oponentShots[0] === 1, wrong: oponentShots[0] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
           <div class="target-item" [ngClass]="{okey: oponentShots[1] === 1, wrong: oponentShots[1] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
           <div class="target-item" [ngClass]="{okey: oponentShots[2] === 1, wrong: oponentShots[2] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
           <div class="target-item" [ngClass]="{okey: oponentShots[3] === 1, wrong: oponentShots[3] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
           <div class="target-item" [ngClass]="{okey: oponentShots[4] === 1, wrong: oponentShots[4] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
           <div class="target-item" [ngClass]="{okey: oponentShots[5] === 1, wrong: oponentShots[5] === -1 }">
            <img src="/assets/base/images/binary-race/okey.svg" alt="" class="okey">
            <img src="/assets/base/images/binary-race/wrong.svg" alt="" class="wrong">
          </div>
          
        </div>

        <div class="my-progress">
          <div class="inner-bar"></div>
        </div>

        <p class="percent" *ngIf="roiright">{{roiright}}%</p>

      </div>

    </div>

  </div>

  <app-binary-winner (fatality)="fatality()" *ngIf="raceEnded === true" [winner]="winner" [winner]="winner" [loser]="loser" [meWon]="meWon"></app-binary-winner>

</div>
<div style="visibility: hidden;">
  <audio #optionPlaced controls>
    <source src='/assets/sound/option_placed.mp3' type="audio/mp3">
</audio>
  <audio #oponentOptionPlaced controls>
    <source src='/assets/sound/option_placed2.mp3' type="audio/mp3">
</audio>
  <audio #optionWin controls>
    <source src='/assets/sound/option_closed_win.mp3' type="audio/mp3">
</audio>
  <audio #optionWinOponent controls>
    <source src='/assets/sound/option_closed_win2.mp3' type="audio/mp3">
</audio>
  <audio #optionLoose controls>
    <source src='/assets/sound/option_closed_loose.mp3' type="audio/mp3">
</audio>
  <audio #optionLooseOponent controls>
    <source src='/assets/sound/option_closed_loose2.mp3' type="audio/mp3">
</audio>

</div>
