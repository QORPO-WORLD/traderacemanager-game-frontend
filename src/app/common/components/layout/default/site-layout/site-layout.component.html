<div class="main hide-on-landscape" #outlet>
  <div
    class="cont-holder main-app-cont-holder"
    [ngClass]="isManager === true ? 'manager' : 'racer'"
  >
    <div class="overlay"></div>
    <nav class="my-nav" [ngClass]="{ 'high-index': menuOpen === true }">
      <div class="items-holder">
        <div
          class="menu-item item1"
          [routerLink]="['/race/start-race']"
          [routerLinkActive]="'active'"
        >
          <img
            src="assets/base/images/start-race/dashboard.png"
            alt="layout image"
          />
          <div class="menu-border my-low-gradient">
            <div class="inner-border"><p>Dashboard</p></div>
          </div>
        </div>

        <div
          class="menu-item item2"
          [routerLink]="['/teams/join-teams']"
          [routerLinkActive]="'active'"
        >
          <img
            src="assets/base/images/start-race/group.png"
            alt="team people image"
          />
          <div class="menu-border my-low-gradient">
            <div class="inner-border"><p>Teams</p></div>
          </div>
          <div class="menu-border"></div>
        </div>

        <div
          class="menu-item item3"
          [routerLink]="['/car/nft-market']"
          [routerLinkActive]="'active'"
        >
          <img
            src="assets/base/images/start-race/marketplace.png"
            alt="marketplace image"
          />
          <div class="menu-border my-low-gradient">
            <div class="inner-border"><p>Marketplace</p></div>
          </div>
          <div class="menu-border"></div>
        </div>

        <div
          class="menu-item item4"
          [routerLink]="['/other/tasks']"
          [routerLinkActive]="'active'"
        >
          <img
            src="assets/base/images/start-race/clipboard.png"
            alt="clipboard image"
          />
          <div class="menu-border my-low-gradient">
            <div class="inner-border"><p>Daily tasks</p></div>
          </div>
          <div class="menu-border"></div>
        </div>

        <div
          class="notifiq-btn"
          [ngClass]="{
            active: shaking === true,
            opened: openNotifiq === true
          }"
        >
          <div class="inner">
            <img
              src="/assets/base/images/start-race/notifiq-bell.svg"
              alt=""
              (click)="openNotifiq = !openNotifiq"
            />
            <span
              *ngIf="numOfNotifications > 0"
              class="noti-count my-cta-btn-back"
              >{{ numOfNotifications }}</span
            >
          </div>
          <div class="notifiq-list" *ngIf="openNotifiq === true">
            <app-notification-list></app-notification-list>
          </div>
          <div
            class="notifiq-back"
            *ngIf="openNotifiq === true"
            (click)="openNotifiq = !openNotifiq"
          ></div>
        </div>
      </div>

      <div class="overview">
        <ng-container *ngIf="showMetaBalance === false">
          <!-- <div (click)="toggleSettings()" class="profile">
            <div class="profile-content">
              <div class="profile-img">
                <img
                  src="assets/base/images/avatars/avatar1-small.png"
                  alt=""
                  *ngIf="Affilate.affiliate_level === 1"
                />
                <img
                  src="assets/base/images/avatars/avatar2-small.png"
                  alt=""
                  *ngIf="Affilate.affiliate_level === 2"
                />
                <img
                  src="assets/base/images/avatars/avatar3-small.png"
                  alt=""
                  *ngIf="Affilate.affiliate_level === 3"
                />
                <img
                  src="assets/base/images/avatars/avatar4-small.png"
                  alt=""
                  *ngIf="Affilate.affiliate_level === 4"
                />
              </div>
              <div class="profile-stats">
                <p class="name">
                  {{ myDriverStats?.nickname }}
                </p>
              </div>
            </div>
            <div
              [ngClass]="{ active: settingsShown === true }"
              class="profile-expander"
            >
              <div class="btn-item" (click)="showMySettings = true">
                <p>
                  <img
                    src="/assets/base/images/menu/settings-icon.svg"
                    alt=""
                  />
                  {{ "profile.acc_settings" | translate }}
                </p>
              </div>
              <div class="btn-item" (click)="logout()">
                <p>
                  <img src="/assets/base/images/menu/logout-icon.svg" alt="" />
                  {{ "profile.log_out" | translate }}
                </p>
              </div>
            </div>
          </div> -->

          <div
            class="overview-item"
            [routerLink]="['/other/wallet-control']"
            [queryParams]="{ controlType: 'deposit' }"
          >
            <div class="bubble-holder">
              <img
                src="/assets/base/images/curr-logos/MATICUSDT-logo.png"
                alt=""
              />
            </div>
            <div class="value-box">
              <p class="number">
                {{ myDriver?.game_wallet_matic | number: "1.2-2":"fr" }}
              </p>
              <p class="add">+</p>
            </div>
          </div>
          <div
            class="overview-item"
            [routerLink]="['/other/wallet-control']"
            [queryParams]="{ controlType: 'deposit' }"
          >
            <div class="bubble-holder ioi">
              <img src="/assets/base/images/logo-blank.png" alt="" />
            </div>
            <div class="value-box">
              <p class="number">
                {{ myDriver?.game_wallet_ioi | number: "1.2-2":"fr" }}
              </p>
              <p class="add">+</p>
            </div>
          </div>
          <div class="overview-item profile-cont" (click)="toggleSettings()">
            <div class="bubble-holder profile">
              <img
                [src]="
                  'assets/base/images/avatars/avatar' +
                  Affilate?.affiliate_level +
                  '-small.png'
                "
                alt=""
              />
            </div>
            <div class="value-box">
              <p>{{ myDriverStats?.nickname }}</p>
            </div>
            <div
              [ngClass]="{ active: settingsShown === true }"
              class="profile-expander"
            >
              <div class="btn-item" (click)="showMySettings = true">
                <p>
                  <img
                    src="/assets/base/images/menu/settings-icon.svg"
                    alt=""
                  />
                  {{ "profile.acc_settings" | translate }}
                </p>
              </div>
              <div class="btn-item" (click)="logout()">
                <p>
                  <img src="/assets/base/images/menu/logout-icon.svg" alt="" />
                  {{ "profile.log_out" | translate }}
                </p>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container *ngIf="showMetaBalance === true">
          <div class="meta-balance-holder">
            <div class="ioi-box my-low-gradient">
              <p>{{ metaEth.ioi }} IOI</p>
            </div>
            <div class="address-box">
              <div class="my-eth">
                <p>{{ metaEth.eth }} ETH</p>
              </div>
              <div
                class="my-address my-cta-btn-back"
                (click)="copyMyAddress(); animateOnClick()"
              >
                <div class="inner">
                  <p>{{ myDriverStats.my_crypto_address | slice: 0:10 }}...</p>
                </div>
                <div class="inner clicked" [ngClass]="myAddressClass">
                  <p>{{ "shared.copied" | translate }}</p>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <div class="balance-switcher" *ngIf="isUsingMetamask === true">
          <div
            class="switch-box"
            [ngClass]="{ active: showMetaBalance === false }"
            (click)="showMetaBalance = false"
          >
            <img
              src="/assets/base/images/start-race/game-balance.svg"
              alt="Game balance icon"
            />
            <img
              class="active"
              src="/assets/base/images/start-race/game-balance-active.svg"
              alt="Game balance icon"
            />
          </div>
          <div
            class="switch-box"
            [ngClass]="{ active: showMetaBalance === true }"
            (click)="showMetaBalance = true"
          >
            <img
              src="/assets/base/images/start-race/meta-balance.svg"
              alt="Metamask balance icon"
            />
            <img
              class="active"
              src="/assets/base/images/start-race/meta-balance-active.svg"
              alt="Metamask balance icon"
            />
          </div>
        </div>

        <div
          class="my-mobile-button"
          (click)="menuOpen = !menuOpen"
          [ngClass]="{ open: menuOpen === true }"
        >
          <span class="my-cta-btn-back"></span>
          <span class="my-cta-btn-back"></span>
          <span class="my-cta-btn-back"></span>
          <span class="my-cta-btn-back"></span>
        </div>
      </div>
    </nav>

    <div class="waiting-popup-holder" *ngIf="depos === true">
      <app-waiting-transfer></app-waiting-transfer>
    </div>

    <div class="mobile-nav">
      <div class="items-holder">
        <div
          class="menu-item item1"
          [routerLink]="['/race/start-race']"
          [routerLinkActive]="'active'"
        >
          <img src="/assets/base/images/menu/dash-mobile.svg" alt="" />
          <img
            class="active blue"
            src="/assets/base/images/menu/dash-mobile-active.svg"
            alt=""
          />
          <img
            class="active red"
            src="/assets/base/images/menu/dash-mobile-red.svg"
            alt=""
          />
        </div>
        <div
          class="menu-item item2"
          [routerLink]="['/teams/my-team']"
          [routerLinkActive]="'active'"
        >
          <img src="/assets/base/images/menu/my-team-mobile.svg" alt="" />
          <img
            class="active blue"
            src="/assets/base/images/menu/my-team-mobile-active.svg"
            alt=""
          />
          <img
            class="active red"
            src="/assets/base/images/menu/my-team-mobile-red.svg"
            alt=""
          />
        </div>
        <div class="menu-item play" [routerLink]="['/race/all-races/']">
          <img
            src="/assets/base/images/menu/play-btn.svg"
            alt=""
            class="blue-play"
          />
          <img
            src="/assets/base/images/menu/play-btn-red.svg"
            alt=""
            class="red-play"
          />
        </div>
        <div
          class="menu-item item3"
          [routerLink]="['/car/nft-market']"
          [routerLinkActive]="'active'"
        >
          <img src="/assets/base/images/menu/market-mobile.svg" alt="" />
          <img
            class="active blue"
            src="/assets/base/images/menu/market-mobile-active.svg"
            alt=""
          />
          <img
            class="active red"
            src="/assets/base/images/menu/market-mobile-red.svg"
            alt=""
          />
        </div>
        <div
          class="menu-item item4"
          [routerLink]="['/other/tasks']"
          [routerLinkActive]="'active'"
        >
          <img src="/assets/base/images/menu/tasks-mobile.svg" alt="" />
          <img
            class="active blue"
            src="/assets/base/images/menu/tasks-mobile-active.svg"
            alt=""
          />
          <img
            class="active red"
            src="/assets/base/images/menu/tasks-mobile-red.svg"
            alt=""
          />
        </div>
      </div>
    </div>

    <router-outlet (activate)="onActivate($event, outlet)"></router-outlet>

    <div class="right-container" [ngClass]="{ open: menuOpen === true }">
      <div class="right-part-holder">
        <div class="menu-switchers">
          <div
            class="switch-item"
            (click)="menuType = 'races'"
            [ngClass]="{ active: menuType === 'races' }"
          >
            <p>{{ "site-layout.races" | translate }}</p>
          </div>
          <div
            class="switch-item"
            (click)="menuType = 'chat'"
            [ngClass]="{ active: menuType === 'chat' }"
          >
            <p>{{ "site-layout.chat" | translate }}</p>
          </div>
          <div class="item-back my-cta-btn-back" [ngClass]="menuType"></div>
        </div>
        <div class="profile-cont my-holder" *ngIf="menuType === 'me'">
          <app-profile-stats
            (menuClose)="closeMenu($event)"
          ></app-profile-stats>
        </div>

        <div class="chat-holder" *ngIf="menuType === 'chat'">
          <app-my-chat></app-my-chat>
        </div>

        <div class="races-holder" *ngIf="menuType === 'races'">
          <div>
            <app-my-races-ad (menuClose)="closeMenu($event)"></app-my-races-ad>
          </div>
        </div>
      </div>
    </div>

    <div class="edit-car-modal small chat" *ngIf="showMySettings === true">
      <div class="modal-back" (click)="showMySettings = false">&nbsp;</div>
      <div class="modal-holder">
        <img
          src="/assets/base/images/icons/close-icon.svg"
          alt=""
          class="close-icon"
          (click)="showMySettings = false"
        />
        <app-my-settings></app-my-settings>
      </div>
    </div>

    <div class="edit-car-modal small" *ngIf="showAff === true">
      <div class="modal-back" (click)="showAff = false">&nbsp;</div>
      <div class="modal-holder">
        <img
          src="/assets/base/images/icons/close-icon.svg"
          alt=""
          class="close-icon"
          (click)="showAff = false"
        />
        <app-my-affiliate></app-my-affiliate>
      </div>
    </div>
  </div>

  <app-notifiq></app-notifiq>

  <div
    class="modal fade"
    id="choose-modal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="turn-lux-modal"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-dialog-centered my-modal-dialog choose-modal"
      role="document"
    >
      <div class="modal-content my-modal-content--tokens">
        <h1>{{ "shared.what_you_do" | translate }}</h1>

        <div class="buttons-holder">
          <div
            class="button-item"
            data-dismiss="modal"
            [routerLink]="['/other/wallet-control']"
            [queryParams]="{ controlType: 'withdraw' }"
          >
            {{ "shared.withdraw_btn" | translate }}
          </div>
          <div
            class="button-item"
            data-dismiss="modal"
            [routerLink]="['/other/wallet-control']"
            [queryParams]="{ controlType: 'transfer' }"
          >
            {{ "shared.transfer_btn" | translate }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="verify-modal" *ngIf="verifyModal === true">
    <div class="modal-holder" *ngIf="verifyStep === 1">
      <div class="items-box">
        <div
          class="small-box racer bordered"
          (click)="selectedMode = 'racer'"
          [ngClass]="{
            selected: selectedMode === 'racer',
            'not-selected': selectedMode === 'owner'
          }"
        >
          <div class="my-border"></div>
          <div class="inner-box">
            <p class="heading-desc">Red</p>
            <img
              src="/assets/base/images/modal/racer-back.png"
              alt=""
              class="back-img"
            />
          </div>
        </div>
        <div
          class="small-box owner"
          (click)="selectedMode = 'owner'"
          [ngClass]="{
            selected: selectedMode === 'owner',
            'not-selected': selectedMode === 'racer'
          }"
        >
          <div class="inner-box">
            <p class="heading-desc">Blue</p>
            <img
              src="/assets/base/images/modal/owner-back.png"
              alt=""
              class="back-img"
            />
          </div>
        </div>
      </div>
      <div class="big-box">
        <div class="text-holder">
          <h2>Pick a colour</h2>
          <p class="antimargin">Choose a colour of your layout</p>
          <p>This can be changed anytime in settings</p>
          <button class="next-btn inactive" *ngIf="selectedMode.length === 0">
            Continue
          </button>
          <button
            class="next-btn"
            *ngIf="selectedMode.length > 0"
            (click)="setMode(selectedMode)"
          >
            Continue
          </button>
        </div>
      </div>
    </div>

    <div class="modal-holder teams" *ngIf="verifyStep === 2">
      <div class="items-box">
        <div class="arrow left" (click)="prevTeamPc()">
          <p>&lt;</p>
        </div>
        <div class="arrow right" (click)="nextTeamPc()">
          <p>&gt;</p>
        </div>

        <div class="pc-arrows-holder">
          <div class="arrow-pc left" (click)="prevTeamPc()">
            <p>&lt;</p>
          </div>
          <div class="arrow-pc right" (click)="nextTeamPc()">
            <p>&gt;</p>
          </div>
        </div>
        <ng-container
          *ngFor="
            let team of myTeams
              | slice: startTeamIndex:startTeamIndex + sliceBalancer;
            let i = index
          "
        >
          <div
            class="small-box"
            (click)="selectedTeam = team.id"
            [ngClass]="{
              selected: selectedTeam === team.id,
              'not-selected': selectedTeam !== team.id && selectedTeam > 0,
              first: i % 3 === 0,
              bordered: i !== 2
            }"
          >
            <div class="my-border"></div>
            <div class="inner-box">
              <img
                src="/assets/base/images/modal/basic-back.png"
                alt=""
                class="back-img"
              />
              <div class="badge-holder">
                <h3>Team {{ team?.name }}</h3>
                <img
                  *ngIf="
                    team?.name === 'IOI' ||
                    team?.name === 'BTC' ||
                    team?.name === 'ALT'
                  "
                  [src]="
                    '/assets/base/images/teams/' + team?.name + '-team.png'
                  "
                  alt=""
                  class="badge-img btc"
                />
                <div
                  class="img-holder"
                  *ngIf="
                    team?.name !== 'IOI' &&
                    team?.name !== 'BTC' &&
                    team?.name !== 'ALT'
                  "
                >
                  <img
                    class="badge-img"
                    [src]="
                      'assets/base/images/custom-teams/custom-team' +
                      (team.avatar + 1) +
                      '.png'
                    "
                    alt=""
                  />
                  <div class="badge-name">
                    <p class="name">{{ team?.name }}</p>
                    <p class="team">TEAM</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- <div
          class="small-box bordered"
          (click)="selectedTeam = 2"
          [ngClass]="{
            selected: selectedTeam === 2,
            'not-selected': selectedTeam !== 2 && selectedTeam > 0
          }"
        >
          <div class="my-border"></div>
          <div class="inner-box">
            <img
              src="/assets/base/images/modal/basic-back.png"
              alt=""
              class="back-img"
            />
            <div class="badge-holder">
              <h3>Team ALT</h3>
              <img
                src="/assets/base/images/teams/ALT-team.png"
                alt=""
                class="badge-img alt"
              />
            </div>
          </div>
        </div>
        <div
          class="small-box"
          (click)="selectedTeam = 3"
          [ngClass]="{
            selected: selectedTeam === 3,
            'not-selected': selectedTeam !== 3 && selectedTeam > 0
          }"
        >
          <div class="inner-box">
            <img
              src="/assets/base/images/modal/basic-back.png"
              alt=""
              class="back-img"
            />
            <div class="badge-holder">
              <h3>Team IOI</h3>
              <img
                src="/assets/base/images/teams/IOI-team.png"
                alt=""
                class="badge-img ioi"
              />
            </div>
          </div>
        </div> -->
      </div>
      <div class="big-box">
        <div class="text-holder">
          <h2>Choose your crypto team</h2>
          <p class="antimargin">
            Join winning teams, get a Premium membership and become a pro racer
            in no time! Compete against other teams and prove that your strategy
            is the best.
          </p>
          <p>Joining a team unlocks player a lot of team based features.</p>
          <button class="next-btn inactive" *ngIf="selectedTeam === 0">
            Continue
          </button>
          <button
            class="next-btn"
            *ngIf="selectedTeam > 0"
            (click)="joinTeamFree(selectedTeam)"
          >
            Continue
          </button>
        </div>
      </div>
    </div>

    <div class="modal-holder simple car" *ngIf="verifyStep === 3">
      <div class="items-box">
        <div class="small-box">
          <div class="inner-box">
            <img
              src="/assets/base/images/modal/basic-back.png"
              alt=""
              class="back-img"
            />
            <div class="asset-holder">
              <img src="/assets/base/images/nft-cars/car0b.png" alt="" />
              <h3>Blue Basic</h3>
            </div>
          </div>
        </div>
      </div>
      <div class="big-box">
        <div class="text-holder">
          <h2>Congratulations, you got a new car!</h2>
          <p>
            This is a free Basic NON NFTs car you received automatically for
            free. Buy our NFTs cars to start earning more money in races and
            also by simply holding them.
          </p>
          <button class="next-btn" (click)="verifyStep = 4">Continue</button>
        </div>
      </div>
    </div>

    <div class="modal-holder simple racer" *ngIf="verifyStep === 4">
      <div class="items-box">
        <div class="small-box">
          <div class="inner-box">
            <img
              src="/assets/base/images/modal/basic-back.png"
              alt=""
              class="back-img"
            />
            <div class="asset-holder">
              <img
                src="/assets/base/images/nft-racers/rookie-basic.png"
                alt=""
              />
              <h3>Racer Rookie</h3>
            </div>
          </div>
        </div>
      </div>
      <div class="big-box">
        <div class="text-holder">
          <h2>Congratulations, you got a new racer!</h2>
          <p>
            You just received common tier NON - NFT avatar. Each avatar has
            special skills. Common level avatars have only their basic affiliate
            function. Buy NFT avatars to gain access to other special skills.
          </p>
          <button class="next-btn" (click)="closeFirstModal(false)">
            Continue
          </button>
        </div>
      </div>
    </div>

    <!-- <section class="teams-sec" *ngIf="verifyStep === 2">
      <div class="modal-heading">
        <h2>{{ "site-layout.pick_team1" | translate }}</h2>
        <p class="desc">{{ "site-layout.pick_team2" | translate }}</p>
      </div>

      <app-teams-selection
        [modalVersion]="true"
        (modalOpen)="closeFirstModal($event)"
      ></app-teams-selection>
    </section> -->
  </div>
</div>
